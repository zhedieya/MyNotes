[toc]



#### 1.定义

**立即执行函数**：声明一个函数，并马上调用这个匿名函数就叫做立即执行函数；即立即执行函数是定义函数以后立即执行该函数。



#### 2.立即函数的写法

JS引擎规定，如果function出现在行首，一律解析成语句。因此JS引擎看到行首是function关键字以后，认为这一段都是函数声明，不应该以原括号结尾，所以就报错了。

解决方法就是不要让function出现在行首，让JS引擎将其理解为一个表达式,最简单的处理就是将其放在一个圆括号里。

即 ①声明一个匿名函数 ②用括号将其包起来 ③加上()调用此函数

- 具体代码

  ```js
  //函数声明
  function fn() {};
  //函数表达式
  var fn = function (){};
  
  
  //立即执行函数的两种写法
  //第一种：用括号把整个函数定义和调用包裹起来
  (function(){
   //function body
  }())
  
  //第二种：用括号把函数定义包裹起来，后面再加括号
  (function (){
   //function body
  })()
  ```

  

#### 3.立即函数的作用

- 不必为函数命名，避免了污染全局变量
- 立即执行函数内部形成了一个独立的作用域，可以封装一些外部无法读取的私有变量，这个作用域里面的变量，外面访问不到，这样就可以避免变量污染
- 封装变量
- **闭包**和私有数据

> 立即执行函数会形成一个单独的作用域，我们可以封装一些临时变量或者局部变量，避免污染全局变量。



#### 4.立即执行函数的参数

- 格式

  ```js
  (function(j){
  //代码中可以使用j
  })(i)
  ```

如果立即执行函数中需要全局变量，全局变量会被作为一个参数传递给立即执行函数（上例中的i就是一个全局变量，i代表的是实参，j是i在立即执行函数中的形参）。

##### 🌰：

```js
// 立即执行函数实现闭包
var arr2 = [];
for (var i = 0; i < 3; i++) {
  // 立即执行函数会形成一个单独的作用域，作用域里面的变量，外面访问不到,可以避免变量污染
  // 立即执行函数只要满足‘访问另一个函数作用域里的变量’就形成了闭包
  arr2[i] = (function (i) { //function里的是独立作用域的i
    return function () {
      console.log(i); //同上
    }
  })(i); //这儿的i是for循环里的i   每次循环都会将该i赋值给循环里独立作用域里i
}

arr2[0]();
arr2[1]();
arr2[2]();
```

